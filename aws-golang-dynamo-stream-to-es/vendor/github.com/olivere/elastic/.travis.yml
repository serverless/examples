sudo: required
language: go
go:
- "1.10.x"
- 1.x
- tip
matrix:
  allow_failures:
  - go: tip
env:
- GO111MODULE=on
services:
- docker
before_install:
- sudo sysctl -w vm.max_map_count=262144
- docker run -d --rm -p 9200:9200  -e "http.host=0.0.0.0" -e "transport.host=127.0.0.1" -e "bootstrap.memory_lock=true" -e "ES_JAVA_OPTS=-Xms1g -Xmx1g" docker.elastic.co/elasticsearch/elasticsearch-oss:6.3.2 elasticsearch -Enetwork.host=_local_,_site_ -Enetwork.publish_host=_local_
- go get -u github.com/fortytw2/leaktest
script:
- go test -race -v . ./config
